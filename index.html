<script>

const ranges=document.querySelectorAll("#impact-calculator input[type=range]");
ranges.forEach(r=>r.addEventListener("input",calculateImpact));

function calculateImpact(){

/* Weighted Model */
let strategy = +strategyRange.value;
let finance = +financeRange.value;
let operations = +operationsRange.value;
let market = +marketRange.value;

/* Weighted Scoring */
let total =
(strategy * 0.30) +
(finance * 0.30) +
(operations * 0.25) +
(market * 0.15);

let percentage = Math.round((total / 10) * 100);

scoreDisplay.innerText=percentage+"%";
progressFill.style.width=percentage+"%";

let center=150;
let radius=120;

let points=[
center, center - radius*(strategy/10),
center + radius*(finance/10), center,
center, center + radius*(operations/10),
center - radius*(market/10), center
];

radarShape.setAttribute("points",
`${points[0]},${points[1]} ${points[2]},${points[3]} ${points[4]},${points[5]} ${points[6]},${points[7]}`
);

/* Badge + Tier */
let tier="";
let badge="";

scoreDisplay.classList.remove("score-glow");

if(percentage>=80){
tier="Enterprise-Ready Infrastructure â€“ Positioned for Institutional Scale.";
badge="ðŸ† Enterprise Certified";
performanceTier.style.color="#00ffcc";
scoreDisplay.classList.add("score-glow");
}
else if(percentage>=65){
tier="Capital Ready â€“ Structured For Strategic Investment.";
badge="âœ” Capital Ready";
performanceTier.style.color="#FFD400";
}
else if(percentage>=50){
tier="Growth Structured â€“ Refinement Required For Capital Efficiency.";
badge="â–² Growth Structured";
performanceTier.style.color="#ff9f43";
}
else{
tier="Foundational Risk â€“ Immediate Infrastructure Development Required.";
badge="âš  Foundational";
performanceTier.style.color="#ff4d4d";
}

performanceTier.innerHTML = tier + "<br><br><strong>" + badge + "</strong>";

/* Lead Capture */
if(percentage < 65){
document.getElementById("reportCapture").style.display="block";
}else{
document.getElementById("reportCapture").style.display="none";
}

}

/* Executive PDF Generator */
function generateReport(){

let reportContent = `
IMPACTGRID STRATEGIC PERFORMANCE REPORT

Overall Score: ${scoreDisplay.innerText}

Assessment Summary:
${performanceTier.innerText}

Generated via IMPACTGRID Performance Calculator.
`;

let newWindow = window.open('', '', 'width=800,height=600');
newWindow.document.write('<pre style="font-family:Inter;padding:40px;">'+reportContent+'</pre>');
newWindow.document.close();
newWindow.print();
}

/* Add Download Button Dynamically */
const downloadBtn = document.createElement("button");
downloadBtn.innerText="Download Executive Report (PDF)";
downloadBtn.onclick=generateReport;
downloadBtn.style.marginTop="25px";
document.getElementById("impact-calculator").appendChild(downloadBtn);

calculateImpact();

</script>
